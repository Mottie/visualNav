/*!
 * Visual Navigation (visualNav) v2.4.1
 * https://github.com/Mottie/visualNav/wiki
 * by Rob Garrison (Mottie)
 * MIT licensed.
 */
;(function(c){c.visualNav=function(g,h){var b,a=this;a.$el=c(g);a.$el.data("visualNav",a);a.init=function(){a.initialized=!1;a.options=b=c.extend({},c.visualNav.defaultOptions,h);a.win=window;a.$win=c(a.win);a.$doc=c(document);var d="html, body";c("html, body").each(function(){var a=c(this),b=a.scrollTop();a.scrollTop(b+1);if(a.scrollTop()===b+1)return d=this.nodeName.toLowerCase(),a.scrollTop(b),!1});a.$body=c(d);a.$lastItem=[null];c.each(b.easing,function(a,d){c.isFunction(c.easing[d])||(b.easing[a]= "swing")});b.stopOnInteraction&&a.$body.bind("scroll mousedown DOMMouseScroll mousewheel keyup",function(b){(0<b.which||"mousedown"===b.type||"mousewheel"===b.type)&&a.$body.stop()});a.$win.bind("scroll resize",function(){a.throttle()});a.update();b.useHash&&a.win.location.hash&&a.animate(a.win.location.hash);a.findLocation();a.$el.find("."+b.selectedClass+(b.selectedAppliedTo===b.link?"":" "+b.link)).trigger("click.visualNav",!0)};a.update=function(){a.$content=c("."+b.contentClass);a.leftMargin= parseInt(a.$content.css("margin-left"),10);a.rightMargin=parseInt(a.$content.css("margin-right"),10);var d,e="."+b.externalLinks;a.$links=c(a.$el.find(b.selectedAppliedTo+(b.selectedAppliedTo===b.link?"":" "+b.link)).map(function(a,b){d=c(b);return!d.hasClass(e)&&!d.closest(e).length?b:null}));e="."+b.contentLinks;a.$links.add(c(e+","+e+" a")).unbind("click.visualNav").bind("click.visualNav",function(d,e){a.animate(c(this).attr(b.targetAttr)||c(this).attr("href"),e);return!1});a.$items=b.selectedAppliedTo=== b.link?a.$links:c(a.$links.map(function(){return c(this).closest(b.selectedAppliedTo)[0]}));a.initialized&&a.findLocation()};a.animate=function(d,e){if("#"!==d&&c(d).length){var f=c(d).eq(0).closest("."+b.contentClass);f.length&&(a.curHash=f[0].id||"",a.$curContent=f,a.initialized&&"function"===typeof b.beforeAnimation&&b.beforeAnimation(a,f),a.$body.stop().animate({scrollLeft:Math.min(f.offset().left,a.$doc.width()-a.$win.width())-a.leftMargin,scrollTop:Math.min(f.offset().top,a.$doc.height()-a.$win.height())}, {queue:!1,duration:a.initialized?b.animationTime:0,easing:b.easing[0],specialEasing:{scrollLeft:b.easing[0]||"swing",scrollTop:b.easing[1]||b.easing[0]||"swing"},complete:function(){a.completed(e)}}))}};a.throttle=function(){a.flag||(a.flag=!0,a.timer=setTimeout(function(){a.flag=!1;a.findLocation()},100))};a.completed=function(c){b.useHash&&(a.win.location.hash=a.curHash);a.initialized?"function"===typeof b.complete&&b.complete(a,a.$curContent):c&&("function"===typeof b.initialized&&b.initialized(a, a.$curContent),a.initialized=!0);a.flag=!1};a.findLocation=function(){var d,e,f,j,g,h,l,n,k=a.$win.width(),p=a.$win.scrollLeft(),q=a.$win.scrollTop(),r=p+k,m=q+a.$win.height(),s=a.$doc.height();a.$items.removeClass(b.inViewClass);b.fitContent&&a.$content.width(k-a.leftMargin-a.rightMargin);a.$links.each(function(k){j=c(this).attr(b.targetAttr);d="#"===j||1>=j.length?"":c(j);d.length&&(f=Math.ceil(d.offset().top),e=Math.ceil(d.offset().left),h=d.outerHeight(),g=f+h+b.bottomMargin,l=d.outerWidth(), n=e+l,f<m&&((f+h-b.bottomMargin>q||g>m)&&e<r&&(e+l-b.bottomMargin>p||n>r))&&a.$items.eq(k).addClass(b.inViewClass))});j=m+b.bottomMargin>=s?":last":":first";a.$items.removeClass(b.selectedClass);a.$curItem=a.$items.filter("."+b.inViewClass+j).addClass(b.selectedClass);a.$curItem[0]!==a.$lastItem[0]&&(a.$lastItem=a.$curItem,a.$content.removeClass(b.currentContent),j=c("."+b.selectedClass+(b.selectedAppliedTo===b.link?"":" "+b.link)).attr(b.targetAttr),a.$curContent=c(j).closest("."+b.contentClass).addClass(b.currentContent), a.initialized&&"function"===typeof b.changed&&b.changed(a,a.$curContent))};a.init()};c.visualNav.defaultOptions={link:"a",targetAttr:"href",selectedAppliedTo:"li",contentClass:"content",contentLinks:"visualNav",externalLinks:"external",useHash:!0,inViewClass:"inView",selectedClass:"selected",currentContent:"current",bottomMargin:100,fitContent:!1,animationTime:1200,easing:["swing","swing"],stopOnInteraction:!0,initialized:null,beforeAnimation:null,complete:null,changed:null};c.fn.visualNav=function(g){return this.each(function(){var h= c(this).data("visualNav");(typeof g).match("object|undefined")?h?h.update():new c.visualNav(this,g):"string"===typeof g&&/^(#|\.)/.test(g)&&h.animate(g)})};c.fn.getvisualNav=function(){return this.data("visualNav")}})(jQuery);
